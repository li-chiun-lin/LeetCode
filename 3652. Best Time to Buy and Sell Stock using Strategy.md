# Medium

You are given two integer arrays $prices$ and $strategy$, where:

- $prices[i]$ is the price of a given stock on the $i$-th day.
- $strategy[i]$ represents a trading action on the $i$-th day, where:
  - $-1$ indicates buying one unit of the stock.
  - $0$ indicates holding the stock.
  - $1$ indicates selling one unit of the stock.

You are also given an even integer $k$, and may perform at most one modification to strategy. A modification consists of:

- Selecting exactly $k$ consecutive elements in strategy.
- Set the first $k / 2$ elements to $0$ (hold).
- Set the last $k / 2$ elements to $1$ (sell).

The profit is defined as the sum of $strategy[i] \times prices[i]$ across all days.

Return the maximum possible profit you can achieve.

```cpp
class Solution {
public:
    long long maxProfit(vector<int>& prices, vector<int>& strategy, int k) {
        int n = size(prices);
        
        // Original prefix sum for strategy * prices
        vector<long long> prefix(n + 1);
        for (int i = 0; i < n; ++i)
            prefix[i + 1] = prefix[i] + strategy[i] * prices[i];
        
        // New prefix sum for prices only (for the sell operations)
        vector<long long> pricePrefix(n + 1);
        for (int i = 0; i < n; ++i)
            pricePrefix[i + 1] = pricePrefix[i] + prices[i];
        
        long long ans = prefix.back();
        
        for (int i = k; i <= n; ++i) {
            // Exclude the window [i-k, i-1]
            long long excluded = prefix[i] - prefix[i - k];
            // Add back the last k/2 elements as sells (coefficient = 1)
            // Last k/2 elements of window [i-k, i-1] are at [i-k/2, i-1]
            long long lastHalfSum = pricePrefix[i] - pricePrefix[i - k / 2];
            long long p = prefix.back() - excluded + lastHalfSum;
            
            ans = max(ans, p);
        }
        
        return ans;
    }
};
```
