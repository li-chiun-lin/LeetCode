# Medium

You are given a string $s$ of length $n$ and an integer array $order$, where $order$ is a permutation of the numbers in the range $[0, n - 1]$.

Starting from time $t = 0$, replace the character at index $order[t]$ in $s$ with '*' at each time step.

A substring is valid if it contains at least one '*'.

A string is active if the total number of valid substrings is greater than or equal to $k$.

Return the minimum time $t$ at which the string $s$ becomes active. If it is impossible, return $-1$.

```cpp
class Solution {
public:
    // Returns the minimum number of steps (time) to reach at least k stars
    int minTime(string s, vector<int>& order, int k) {
        long long cnt = 0;          // Count of star pairs formed so far
        int n = (int)s.size();

        // Maintain a sorted set of star positions, including sentinel boundaries
        set<int> star;
        star.insert(-1);  // Left boundary before index 0
        star.insert(n);   // Right boundary after last index

        // Process stars in the given order
        for (int t = 0; t < (int)order.size(); ++t) {
            int i = order[t];
            star.insert(i);          // Insert current star position into the set

            auto it = star.find(i);
            int prv = *prev(it);     // Previous star index to the left
            int nxt = *next(it);     // Next star index to the right

            // Calculate the contribution of new star i to count:
            // number of pairs formed between intervals [prv+1, i] and [i, nxt-1]
            long long left = i - prv;
            long long right = nxt - i;

            cnt += left * right;     // Add pairs contributed by current insertion

            // Check if accumulated pairs reach or exceed threshold k
            if (cnt >= k)
                return t;            // Return the step count when condition met
        }

        return -1;  // If never reach k pairs, return -1
    }
};
```
