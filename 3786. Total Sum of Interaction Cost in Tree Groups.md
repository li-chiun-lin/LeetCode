# Hard

You are given an integer $n$ and an undirected tree with $n$ nodes numbered from $0$ to $n - 1$. This is represented by a 2D array $edges$ of length $n - 1$, where $edges[i] = [u_i, v_i]$ indicates an undirected edge between nodes $u_i$ and $v_i$.

You are also given an integer array $group$ of length $n$, where $group[i]$ denotes the group label assigned to node $i$.

- Two nodes $u$ and $v$ are considered part of the same group if $group[u] == group[v]$.
- The interaction cost between $u$ and $v$ is defined as the number of edges on the unique path connecting them in the tree.

Return an integer denoting the sum of interaction costs over all unordered pairs $(u, v)$ with $u \neq v$ such that $group[u] == group[v]$.

```cpp
class Solution
{
public:
    long long interactionCosts(int n, vector<vector<int>>& edges, vector<int>& group)
    {
        vector<vector<int>> adj(n);
        for (auto& e : edges)
        {
            adj[e[0]].push_back(e[1]);
            adj[e[1]].push_back(e[0]);
        }

        vector<long long> totalCount(21, 0);
        for (int g : group)
        {
            totalCount[g]++;
        }

        vector<vector<long long>> cnt(n, vector<long long>(21, 0));

        return dfs(0, -1, adj, group, totalCount, cnt);
    }

private:
    long long dfs(
        int u,
        int parent,
        vector<vector<int>>& adj,
        vector<int>& group,
        vector<long long>& totalCount,
        vector<vector<long long>>& cnt
    )
    {
        long long sum = 0;

        cnt[u][group[u]] = 1;

        for (int v : adj[u])
        {
            if (v == parent)
                continue;

            sum += dfs(v, u, adj, group, totalCount, cnt);

            // contribution of edge (u, v)
            for (int g = 1; g <= 20; ++g)
            {
                long long c = cnt[v][g];
                if (c > 0)
                {
                    sum += c * (totalCount[g] - c);
                }
                cnt[u][g] += c;
            }
        }

        return sum;
    }
};
```
