# Medium

You are given a string array $words$, consisting of distinct 4-letter strings, each containing lowercase English letters.

A word square consists of 4 distinct words: $top$, $left$, $right$ and $bottom$, arranged as follows:

- $top$ forms the top row.
- $bottom$ forms the bottom row.
- $left$ forms the left column (top to bottom).
- $right$ forms the right column (top to bottom).

It must satisfy:

- $top[0] == left[0], top[3] == right[0]$
- $bottom[0] == left[3], bottom[3] == right[3]$

Return all valid distinct word squares, sorted in ascending lexicographic order by the 4-tuple $(top, left, right, bottom)$​​​​​​​.

```cpp
class Solution {
public:
    vector<vector<string>> wordSquares(vector<string>& words) {
        vector<vector<string>> ans;
        int n = size(words);
        int ub = 1 << n;

        sort(begin(words), end(words));

        for (int i = 1; i < ub; ++i)
        {
            if (__builtin_popcount(i) != 4)
                continue;

            vector<string> w(4);

            for (int j = 0, k = 0; j < n; ++j)
                if ((1 << j) & i)
                    w[k ++] = words[j];

            do
            {
                if (w[0][0] == w[1][0] && w[0][3] == w[2][0] && w[3][0] == w[1][3] && w[3][3] == w[2][3])
                    ans.push_back(w);
                
            } while (next_permutation(begin(w), end(w)));
        }

        sort(begin(ans), end(ans));

        return ans;
    }
};
```
